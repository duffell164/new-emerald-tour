<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Emerald Tour Leaderboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@7.0.2/css/flag-icons.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <style>
        /* Original styling preserved */
        /* This keeps the whole app centered and neat */
.leaderboard-container {
    max-width: 1300px;
    margin: 0 auto;
    background-color: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    overflow: hidden; /* Header won't scroll */
}

/* New wrapper to contain only the scrollable table */
.table-wrapper {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    width: 100%;
}

table {
    width: 100%;
    border-collapse: collapse;
    /* Force the table to be wide enough to require scrolling on mobile */
    min-width: 900px; 
}

/* Fix for the header to ensure it stays centered regardless of table scroll */
.header, .info-bar, .venue {
    width: 100%;
    box-sizing: border-box;
}
        .header {
            background: linear-gradient(135deg, #124d12 0%, #228B22 50%, #1a5e1a 100%);
            color: white;
            padding: 25px 80px !important;
            text-align: center;
            font-size: 28px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 3px;
            border-bottom: 4px solid #FFD700;
            position: relative;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .header img { position: absolute; top: 50%; transform: translateY(-50%); height: 50px; width: auto; }
        .logo-left { left: 40px; }
        .logo-right { right: 50px; }
        @media (max-width: 600px) { .header img { display: none; } }

        .info-bar { display: flex; justify-content: space-around; background: #333; color: #ddd; padding: 12px 15px; font-size: 14px; }
        .info-item { font-weight: bold; color: #FFD700; }
        .info-item span { color: white; margin-left: 8px; }
        .venue { background: #444; color: #FFFFF7; padding: 12px 15px; text-align: center; font-size: 18px; font-weight: bold; }
        .venue.major { background: linear-gradient(90deg, #8B6914 0%, #FFD700 50%, #8B6914 100%) !important; color: #000 !important; }

        table { width: 100%; border-collapse: collapse; min-width: 1000px; }
        th { background-color: #e6e6e6; padding: 12px; text-align: left; font-size: 14px; border-bottom: 2px solid #ddd; }
        td { padding: 8px 12px; border-bottom: 1px solid #ddd; font-size: 16px; }
        .to-par { font-weight: bold; text-align: center; font-size: 18px; }
        .to-par.under { color: #8B0000; }
        .to-par.even { color: #1AA260; }
        .pos { font-weight: bold; width: 60px; text-align: center; }
        .player-content { display: flex; align-items: center; padding-left: 10px; font-weight: 600; }
        .score-input { width: 60px; text-align: center; border: none; background: transparent; font-size: 16px; }
        .prize, .season-earnings { font-weight: bold; text-align: center; }
        
        .bonus-table-container { margin-top: 30px; }
        .bonus-header { background-color: #E8E8E8; padding: 12px; font-weight: bold; }
        .history-container { margin-top: 30px; }
        .history-header { background-color: #228B22; color: white; padding: 12px; font-weight: bold; cursor: pointer; }
        .hof-container { margin-top: 40px; padding: 20px; background: #1a1a1a; color: white; border-radius: 12px; }
        .hof-cards { display: flex; justify-content: space-around; gap: 20px; flex-wrap: wrap; }
        .hof-card { background: rgba(255,255,255,0.1); padding: 20px; width: 250px; text-align: center; border-radius: 8px; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="leaderboard-container">
        <div class="header">
            <img src="2k25 logo.png" class="logo-left" alt="2K25 Logo">
            <span id="header-text-content"><span style="color: #FFD700;">‚óè</span> New Emerald Tour Leaderboard</span>
            <img src="FedEx-Cup-logo.png" class="logo-right" alt="PGA Tour Logo">
        </div>

        <div class="info-bar">
            <div class="info-item">Date: <span id="date-field"></span></div>
            <div class="info-item">Course Par: <span id="course-par">72</span></div>
            <div class="info-item">Prize Pool: <span id="prize-pool">$500,000</span></div>
        </div>

        <div class="venue" id="venue-field">Season 1, Week 1</div>

        <div class="table-wrapper">
    <table id="leaderboard-table">
        <thead>
                <tr>
                    <th class="pos">POS</th>
                    <th>PLAYER</th>
                    <th class="to-par">TO PAR</th>
                    <th class="round-score">R1</th>
                    <th class="round-score">R2</th>
                    <th class="round-score">R3</th>
                    <th class="round-score">R4</th>
                    <th class="total">TOTAL</th>
                    <th class="prize">PRIZE (v$)</th>
                </tr>
            </thead>
        <tbody id="leaderboard-body"></tbody>
    </table>
</div>

        <div class="bonus-table-container">
            <div class="bonus-header" id="season-header">SEASON STATS</div>
            <table class="bonus-table">
                <thead>
                    <tr>
                        <th class="player">PLAYER</th>
                        <th class="season-points">POINTS</th>
                        <th class="season-earnings">TOTAL (v$)</th>
                        <th class="season-events">EVENTS</th>
                        <th>FiR %</th>
                        <th>GiR %</th>
                        <th>Scrambling %</th>
                        <th>NTP (ft)</th>
                    </tr>
                </thead>
                <tbody id="bonus-body"></tbody>
            </table>
        </div>

        <div class="history-container">
            <div class="history-header" onclick="document.getElementById('history-table').classList.toggle('hidden')">Season Event History ‚ñº</div>
            <table id="history-table" class="history-table hidden">
                <thead>
                    <tr><th>Event</th><th>Venue</th><th>Date</th><th>Winner</th><th>Prize</th></tr>
                </thead>
                <tbody id="history-body"></tbody>
            </table>
        </div>

        <div class="hof-container">
            <div class="hof-header" style="text-align: center; color: #FFD700; margin-bottom: 20px;">üèÜ Emerald Tour Hall of Fame üèÜ</div>
            <div class="hof-cards" id="hof-display"></div>
        </div>
    </div>

    <script>
        // Update these GIDs with your specific Tab IDs from the Google Sheet URL
        const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSoGXmOEYNiMsVMIlQv-PCbb_rMZibcL8t1nhjgwUeT-Fi35kBGD6ED81g7zQEsa726jVI7jax5Tvbx/pub?output=csv';
        const GID_LB = '&gid=0';
        const GID_STATS = '&gid=YOUR_STATS_GID'; 
        const GID_HIST = '&gid=YOUR_HISTORY_GID';

        async function loadSheetData() {
            try {
                // Fetch Leaderboard
                const lbRes = await fetch(CSV_URL + GID_LB);
                const lbData = await lbRes.text();
                renderLeaderboard(lbData);

                // Fetch Stats
                const statsRes = await fetch(CSV_URL + GID_STATS);
                const statsData = await statsRes.text();
                renderStats(statsData);

                // Fetch History
                const histRes = await fetch(CSV_URL + GID_HIST);
                const histData = await histRes.text();
                renderHistory(histData);

            } catch (e) { console.error("Data load failed", e); }
        }

function renderLeaderboard(csv) {
            const rows = csv.split('\n').slice(1);
            const tbody = document.getElementById('leaderboard-body');
            tbody.innerHTML = '';

            rows.forEach((row, index) => {
                const col = row.split(',');
                if (!col[1]) return;

                const tr = document.createElement('tr');
                
                // Calculate Total and To Par
                const scores = [col[3], col[4], col[5], col[6]].map(s => parseInt(s) || 0);
                const validScores = scores.filter(s => s > 0);
                const total = validScores.reduce((a, b) => a + b, 0);
                const par = parseInt(document.getElementById('course-par').textContent) || 72;
                const toPar = validScores.length > 0 ? total - (par * validScores.length) : null;
                
                tr.innerHTML = `
                    <td class="pos">${index + 1}</td>
                    <td class="player">
                        <div class="player-content">
                            <span>${col[1]}</span>
                        </div>
                    </td>
                    <td class="to-par ${toPar < 0 ? 'under' : 'even'}">${toPar === null ? '-' : (toPar > 0 ? '+' : '') + (toPar === 0 ? 'E' : toPar)}</td>
                    <td class="round-score">${col[3] || '-'}</td>
                    <td class="round-score">${col[4] || '-'}</td>
                    <td class="round-score">${col[5] || '-'}</td>
                    <td class="round-score">${col[6] || '-'}</td>
                    <td class="total">${total || '-'}</td>
                    <td class="prize">${col[8] || '$0'}</td>
                `;
                tbody.appendChild(tr);
            });
            
            const venue = document.getElementById('venue-field');
            if (/major/i.test(venue.textContent)) venue.classList.add('major');
        }
            
            // Apply gold styling if "Major" is in the venue
            const venue = document.getElementById('venue-field');
            if (/major/i.test(venue.textContent)) venue.classList.add('major');
        }

        function renderStats(csv) {
            const rows = csv.split('\n').slice(1);
            const tbody = document.getElementById('bonus-body');
            const hof = document.getElementById('hof-display');
            tbody.innerHTML = '';
            hof.innerHTML = '';

            rows.forEach((row, i) => {
                const col = row.split(',');
                if (!col[0]) return;

                tbody.innerHTML += `
                    <tr>
                        <td>${col[0]}</td><td>${col[1]}</td><td>$${col[2]}</td><td>${col[3]}</td>
                        <td>${col[4]}%</td><td>${col[5]}%</td><td>${col[6]}%</td><td>${col[7]}ft</td>
                    </tr>
                `;

                // Update Hall of Fame Top 3
                if (i < 3) {
                    const medals = ['ü•á', 'ü•à', 'ü•â'];
                    hof.innerHTML += `
                        <div class="hof-card">
                            <div style="font-size:40px;">${medals[i]}</div>
                            <div style="font-weight:bold;">${col[0]}</div>
                            <div>Points: ${col[1]}</div>
                        </div>
                    `;
                }
            });
        }

        function renderHistory(csv) {
            const rows = csv.split('\n').slice(1);
            const tbody = document.getElementById('history-body');
            tbody.innerHTML = rows.map(r => `<tr>${r.split(',').map(c => `<td>${c}</td>`).join('')}</tr>`).join('');
        }

        window.onload = loadSheetData;
    </script>
</body>
</html>


